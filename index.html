<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bright Test World</title>
<style>
body { margin:0; overflow:hidden; }
#ui{
position:absolute;
top:20px;
left:20px;
color:black;
font-family:monospace;
background:white;
padding:10px;
}
</style>
</head>
<body>

<div id="ui">
WASDで移動
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>

<script>

// シーン
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87ceeb); // 空色

// カメラ
const camera = new THREE.PerspectiveCamera(
75,
window.innerWidth/window.innerHeight,
0.1,
1000
);
camera.position.set(0,20,40);
camera.lookAt(0,0,0);

// レンダラー
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// 強い太陽光
const sun = new THREE.DirectionalLight(0xffffff, 3);
sun.position.set(50,100,50);
scene.add(sun);

// 環境光
const ambient = new THREE.AmbientLight(0xffffff, 1);
scene.add(ambient);

// 地面
const floorGeometry = new THREE.PlaneGeometry(200,200);
const floorMaterial = new THREE.MeshStandardMaterial({
color: 0x228B22
});
const floor = new THREE.Mesh(floorGeometry, floorMaterial);
floor.rotation.x = -Math.PI/2;
scene.add(floor);

// プレイヤー
const playerGeometry = new THREE.BoxGeometry(3,3,3);
const playerMaterial = new THREE.MeshStandardMaterial({
color: 0xff0000
});
const player = new THREE.Mesh(playerGeometry, playerMaterial);
player.position.y = 1.5;
scene.add(player);

// 目標キューブ
const targetGeometry = new THREE.BoxGeometry(5,5,5);
const targetMaterial = new THREE.MeshStandardMaterial({
color: 0x0000ff
});
const target = new THREE.Mesh(targetGeometry, targetMaterial);
target.position.set(0,2.5,-50);
scene.add(target);

// キー入力
let keys = {};
document.addEventListener("keydown", e=>keys[e.code]=true);
document.addEventListener("keyup", e=>keys[e.code]=false);

// アニメーション
function animate(){
requestAnimationFrame(animate);

// 移動
if(keys["KeyW"]) player.position.z -= 0.5;
if(keys["KeyS"]) player.position.z += 0.5;
if(keys["KeyA"]) player.position.x -= 0.5;
if(keys["KeyD"]) player.position.x += 0.5;

// カメラ追従
camera.position.x = player.position.x;
camera.position.z = player.position.z + 40;
camera.lookAt(player.position);

// 当たり判定
const dx = player.position.x - target.position.x;
const dz = player.position.z - target.position.z;
const dist = Math.sqrt(dx*dx + dz*dz);

if(dist < 5){
document.getElementById("ui").innerHTML = "GOAL!";
}

renderer.render(scene,camera);
}

animate();

</script>
</body>
</html>
